<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <title>é‹å‹•æ‰“å¡ App - é¦–é </title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
    <div class="container">
        <header class="app-header">
            <h1>é‹å‹•æ‰“å¡ ç¤¾ç¾¤ç‰†</h1>
        </header>

        <section class="feed">
            {% for post in posts %}
            <article class="post" data-post-id="{{ post.id }}">
                <div class="post-header">
                    <div style="display:flex; align-items:center; gap:8px;">
                        {% if post.avatar %}
                            <img src="{{ post.avatar }}" class="avatar" alt="avatar">
                        {% else %}
                            <div class="avatar placeholder">{{ post.user[0]|upper }}</div>
                        {% endif %}
                        {% if post.visibility and post.visibility == 'friends' %}
                            <span title="åƒ…å¥½å‹å¯è¦‹" style="font-size:0.9em;color:#999; margin-left:6px;">ğŸ”’</span>
                        {% endif %}
                        <strong class="post-user">{{ post.user }}</strong>
                    </div>
                    <span class="post-time">{{ post.created_at }}</span>
                </div>
                <div class="post-body">
                    <p><strong>{{ post.sport }}</strong> â€¢ {{ post.minutes }} åˆ†é˜</p>
                    {% if post.message %}
                    <p class="post-message">{{ post.message }}</p>
                    {% endif %}
                    {% if post.image %}
                        <img src="{{ post.image }}" class="post-image">
                    {% endif %}
                </div>
                <div class="post-actions">
                    <button class="like-btn btn small" data-post-id="{{ post.id }}">ğŸ‘ <span class="like-count">{{ post.likes }}</span></button>
                    <button class="comment-toggle btn small" data-post-id="{{ post.id }}">ğŸ’¬ ç•™è¨€ ({{ post.comments|length }})</button>
                </div>
                <div class="comments" id="comments-{{ post.id }}" style="display:none;">
                    <ul class="comment-list">
                        {% for c in post.comments %}
                        <li><strong>{{ c.user }}</strong>: {{ c.text }} <span class="c-time">{{ c.time }}</span></li>
                        {% endfor %}
                    </ul>
                    <form class="comment-form" data-post-id="{{ post.id }}">
                        <input type="text" name="user" placeholder="ä½ çš„åç¨±ï¼ˆé¸å¡«ï¼‰" class="input-small">
                        <input type="text" name="text" placeholder="å¯«ä¸‹ä½ çš„ç•™è¨€..." required class="input-small">
                        <button type="submit" class="btn small">é€å‡º</button>
                    </form>
                </div>
            </article>
            {% else %}
            <p>ç›®å‰é‚„æ²’æœ‰è²¼æ–‡ï¼Œå¿«å»æ–°å¢ä½ çš„ç¬¬ä¸€ç¯‡æ‰“å¡è²¼æ–‡ï¼</p>
            {% endfor %}
        </section>
    </div>

    <!-- Bottom nav (7 items) -->
    <div class="bottom-nav">
        <a href="{{ url_for('index') }}" class="nav-item">é¦–é </a>
        <a href="{{ url_for('friends_page') }}" class="nav-item">å¥½å‹</a>
        <a href="{{ url_for('profile_page') }}" class="nav-item">å€‹äºº</a>
        <a href="{{ url_for('checkin') }}" class="nav-item checkin-btn">æ‰“å¡</a>
        <a href="{{ url_for('leaderboard_page') }}" class="nav-item">æ’è¡Œæ¦œ</a>
        <a href="{{ url_for('stats') }}" class="nav-item">åˆ†æ</a>
        <a href="{{ url_for('badges_page') }}" class="nav-item">å¾½ç« </a>
    </div>

    <script src="{{ url_for('static', filename='app.js') }}"></script>
</body>
</html>
